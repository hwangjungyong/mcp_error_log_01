# AI 에러 로그 분석 시스템 - 설치 및 구성 가이드

## 개요

이 문서는 AI 에러 로그 분석 시스템을 다른 프로젝트에 통합하거나 독립적으로 설치하는 방법을 안내합니다. 특히 **MCP (Model Context Protocol) 서버 구조**와 **다른 AI 시스템 (예: aipro)에 설치하는 방법**을 중점적으로 설명합니다.

## 시스템 요구사항

### 필수 소프트웨어

1. **Node.js** (v18 이상)
   - 공식 웹사이트: https://nodejs.org/
   - 설치 확인: `node --version`

2. **Python** (v3.8 이상)
   - 공식 웹사이트: https://www.python.org/
   - 설치 확인: `python --version`

3. **npm** (Node.js와 함께 자동 설치)
   - 설치 확인: `npm --version`

### 시스템 요구 사항

- **운영체제**: Windows 10/11, macOS, Linux
- **메모리**: 최소 4GB RAM (권장 8GB 이상)
- **디스크 공간**: 최소 500MB 여유 공간
- **네트워크**: 인터넷 연결 (의존성 설치 및 AI 분석 시)

## 설치 방법

### 1. 프로젝트 복사

이미 구성된 프로젝트를 사용하는 경우:
```bash
# 프로젝트 폴더로 이동
cd C:\test\mcp_error_log_01
```

새로운 위치에 설치하는 경우:
```bash
# 프로젝트 폴더를 원하는 위치로 복사
xcopy C:\test\mcp_error_log_01 C:\your\desired\path\ /E /I
cd C:\your\desired\path
```

### 2. Node.js 의존성 설치

```bash
npm install
```

설치되는 주요 패키지:
- `vue`: Vue.js 프레임워크
- `sql.js`: SQLite 데이터베이스 (브라우저/Node.js)
- `vite`: 프론트엔드 빌드 도구
- `@vitejs/plugin-vue`: Vue.js 플러그인
- `concurrently`: 여러 명령어 동시 실행

### 3. Python 의존성 설치

```bash
pip install mcp anthropic
```

또는 requirements.txt 사용:
```bash
pip install -r requirements.txt
```

**requirements.txt 내용:**
```
mcp>=0.1.0
anthropic>=0.3.0
```

### 4. 환경 변수 설정

`.env` 파일을 프로젝트 루트에 생성:
```env
# API 서버 설정
PORT=3011

# Vite 개발 서버 포트
VITE_PORT=5183

# API Base URL
VITE_API_BASE_URL=http://localhost:3011
```

**포트 변경이 필요한 경우:**
- `PORT`: API 서버 포트 (기본값: 3011)
- `VITE_PORT`: 프론트엔드 개발 서버 포트 (기본값: 5183)
- 다른 애플리케이션과 포트가 충돌하는 경우 값을 변경하세요.

### 5. 데이터베이스 초기화

데이터베이스는 API 서버 첫 실행 시 자동으로 생성됩니다:
- 위치: `data/database.db`
- 수동으로 초기화하려면 `data` 폴더를 생성하세요:
```bash
mkdir data
```

## 실행 방법

### 개발 모드

#### 방법 1: 통합 실행 (권장)
```bash
npm start
```
- API 서버와 프론트엔드 서버를 동시에 실행합니다.
- `concurrently` 패키지를 사용하여 두 서버를 병렬로 실행합니다.

#### 방법 2: 개별 실행
```bash
# 터미널 1: API 서버
npm run api-server

# 터미널 2: 프론트엔드 개발 서버
npm run dev
```

### 프로덕션 모드

1. 프론트엔드 빌드:
```bash
npm run build
```

2. 빌드된 파일 서빙:
```bash
npm run preview
```

3. API 서버는 별도로 실행:
```bash
npm run api-server
```

## 접속 방법

설치 및 실행이 완료되면:

- **프론트엔드**: http://localhost:5183
- **API 서버**: http://localhost:3011

브라우저에서 http://localhost:5183 으로 접속하세요.

## MCP 서버 설치 및 구성 (다른 AI 시스템용)

### MCP 서버란?

**MCP (Model Context Protocol)**는 AI 모델과 외부 도구/서비스를 연결하는 표준 프로토콜입니다. 이 프로젝트는 Python으로 구현된 MCP 서버를 포함하고 있으며, 다른 AI 시스템 (예: aipro, Claude Desktop 등)에서도 사용할 수 있습니다.

### MCP 서버 독립 설치

#### 1. Python MCP 서버만 사용하기

**필요 파일:**
- `mcp-error-log-analyzer.py` (MCP 서버)
- Python 의존성: `mcp`, `anthropic`

**설치 방법:**

```bash
# 1. Python 의존성 설치
pip install mcp anthropic

# 2. MCP 서버 파일 복사
cp mcp-error-log-analyzer.py /your/mcp/servers/

# 3. 실행 권한 부여 (Linux/macOS)
chmod +x mcp-error-log-analyzer.py
```

**MCP 서버 설정 파일 (예: Claude Desktop)**

Claude Desktop의 경우 `claude_desktop_config.json`에 추가:

```json
{
  "mcpServers": {
    "error-log-analyzer": {
      "command": "python",
      "args": [
        "/path/to/mcp-error-log-analyzer.py"
      ],
      "env": {
        "ANTHROPIC_API_KEY": "your-api-key-here"
      }
    }
  }
}
```

**aipro 또는 다른 AI 시스템의 경우:**

각 AI 시스템의 MCP 설정 방법에 따라:
1. MCP 서버 경로 지정
2. Python 인터프리터 경로 지정
3. 환경 변수 설정 (ANTHROPIC_API_KEY 등)

#### 2. 전체 시스템 설치 (권장)

**장점:**
- 웹 UI 제공
- 데이터베이스 저장 기능
- 이력 관리 기능
- 독립 실행 가능

**설치 단계:**

```bash
# 1. 프로젝트 복제 또는 다운로드
git clone <repository-url>
cd mcp_error_log_01

# 2. Node.js 의존성 설치
npm install

# 3. Python 의존성 설치
pip install mcp anthropic

# 4. 환경 변수 설정
# .env 파일 생성 및 설정
echo "PORT=3011" > .env
echo "VITE_PORT=5183" >> .env
echo "VITE_API_BASE_URL=http://localhost:3011" >> .env

# 5. 서버 실행
npm start
```

### MCP 서버 통신 방식

#### 표준 입출력 (stdio) 통신

MCP 서버는 표준 입출력을 통해 JSON-RPC 형식으로 통신합니다:

**요청 형식:**
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "analyze_error_log",
    "arguments": {
      "log_content": "에러 로그 내용...",
      "log_file_path": "경로 (선택)"
    }
  }
}
```

**응답 형식:**
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "<JSON_START>{...}<JSON_END>"
      }
    ]
  }
}
```

#### Node.js에서 MCP 서버 호출

```javascript
import { spawn } from 'child_process';

// Python MCP 서버 실행
const pythonProcess = spawn('python', ['mcp-error-log-analyzer.py'], {
  stdio: ['pipe', 'pipe', 'pipe'],
  encoding: 'utf-8'
});

// 요청 전송
const request = {
  jsonrpc: '2.0',
  id: 1,
  method: 'tools/call',
  params: {
    name: 'analyze_error_log',
    arguments: {
      log_content: '에러 로그 내용...'
    }
  }
};

pythonProcess.stdin.write(JSON.stringify(request) + '\n');

// 응답 수신
let output = '';
pythonProcess.stdout.on('data', (data) => {
  output += data.toString();
  
  // JSON 결과 추출
  const jsonMatch = output.match(/<JSON_START>([\s\S]*?)<JSON_END>/);
  if (jsonMatch) {
    const result = JSON.parse(jsonMatch[1]);
    console.log('분석 결과:', result);
  }
});
```

### 다른 AI 시스템에 통합하기

#### aipro에 통합

**방법 1: MCP 서버만 사용**
1. `mcp-error-log-analyzer.py` 파일을 aipro의 MCP 서버 디렉토리에 복사
2. aipro의 설정 파일에 MCP 서버 등록
3. aipro에서 "에러 로그 분석" 도구 사용

**방법 2: 전체 시스템 통합**
1. 이 프로젝트를 독립적으로 실행
2. aipro에서 HTTP API를 통해 연동
3. 또는 aipro의 웹뷰 기능을 사용하여 iframe으로 임베드

#### Claude Desktop에 통합

**설정 파일 위치:**
- **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`
- **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`

**설정 예시:**
```json
{
  "mcpServers": {
    "error-log-analyzer": {
      "command": "python",
      "args": [
        "C:\\path\\to\\mcp-error-log-analyzer.py"
      ],
      "env": {
        "ANTHROPIC_API_KEY": "sk-ant-..."
      }
    }
  }
}
```

**사용 방법:**
1. Claude Desktop 재시작
2. Claude와 대화 중 "@error-log-analyzer" 언급
3. "에러 로그 분석" 도구 사용

## 다른 프로젝트에 통합하기

### 1. 컴포넌트 통합

#### Vue.js 프로젝트에 통합

1. **컴포넌트 복사**
```bash
# ErrorLogAnalysis.vue 복사
cp src/components/ErrorLogAnalysis.vue [대상프로젝트]/src/components/

# 유틸리티 복사
cp src/config/api.js [대상프로젝트]/src/config/
cp src/utils/helpers.js [대상프로젝트]/src/utils/
```

2. **App.vue에 통합**
```vue
<template>
  <div id="app">
    <!-- 기존 코드... -->
    
    <!-- AI 에러로그분석 섹션 추가 -->
    <div class="error-log-analysis-section">
      <button @click="showErrorLogAnalysis = true">
        AI 에러로그분석
      </button>
      <button @click="loadErrorLogStatus">
        AI 에러로그 현황
      </button>
    </div>

    <!-- 모달 -->
    <div v-if="showErrorLogAnalysis" class="modal-overlay">
      <div class="modal-content">
        <ErrorLogAnalysis @close="showErrorLogAnalysis = false" />
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import ErrorLogAnalysis from './components/ErrorLogAnalysis.vue'

const showErrorLogAnalysis = ref(false)
</script>
```

3. **스타일 복사**
```bash
# src/style.css에서 에러 로그 관련 스타일 복사
```

### 2. 백엔드 통합

#### API 서버 통합

1. **파일 복사**
```bash
# API 서버 및 데이터베이스 파일 복사
cp api-server.js [대상프로젝트]/
cp database.js [대상프로젝트]/
cp mcp-error-log-analyzer.py [대상프로젝트]/
```

2. **기존 API 서버에 엔드포인트 추가**

`api-server.js`에서 에러 로그 관련 엔드포인트만 추출:
- `POST /api/error-log/analyze`
- `POST /api/error-log/save`
- `GET /api/error-log/history`

3. **데이터베이스 통합**

기존 데이터베이스가 있는 경우:
- `database.js`의 `errorLogsDB` 부분만 추출
- 기존 데이터베이스 초기화 로직에 `error_logs` 및 `error_log_metadata` 테이블 추가

### 3. 독립 실행 모드 (현재 구성)

별도의 포트로 완전히 독립적으로 실행:
- API 서버: 3011
- 프론트엔드: 5183

이 방식은 다른 프로젝트와 충돌 없이 독립적으로 실행 가능합니다.

## 포트 설정 가이드

### 충돌 방지를 위한 포트 변경

다른 애플리케이션과 포트가 충돌하는 경우:

1. **.env 파일 수정**
```env
PORT=3021  # 예: 3011 → 3021
VITE_PORT=5193  # 예: 5183 → 5193
VITE_API_BASE_URL=http://localhost:3021
```

2. **src/config/api.js 확인**
```javascript
// 환경 변수에서 자동으로 읽어오므로 수정 불필요
// 하드코딩된 포트가 있다면 제거하세요
```

3. **vite.config.js 수정**
```javascript
export default defineConfig({
  server: {
    port: 5193, // VITE_PORT와 동일하게
    proxy: {
      '/api': {
        target: 'http://localhost:3021', // PORT와 동일하게
        changeOrigin: true,
      }
    }
  }
})
```

## 문제 해결

### 설치 중 오류

#### npm install 실패
```bash
# npm 캐시 정리
npm cache clean --force
npm install
```

#### Python 패키지 설치 실패
```bash
# pip 업그레이드
python -m pip install --upgrade pip
pip install mcp anthropic
```

### 실행 중 오류

#### API 서버 연결 실패
1. API 서버가 실행 중인지 확인
```bash
# Windows
netstat -ano | findstr :3011

# macOS/Linux
lsof -i :3011
```

2. 방화벽 설정 확인
3. 포트 충돌 확인 및 변경

#### Python 스크립트 실행 오류
1. Python 경로 확인
```bash
python --version
# 또는
python3 --version
```

2. Python 의존성 재설치
```bash
pip install --upgrade mcp anthropic
```

3. 환경 변수 확인
```bash
# Windows
set PYTHONIOENCODING=utf-8

# macOS/Linux
export PYTHONIOENCODING=utf-8
```

#### 데이터베이스 오류
1. `data` 폴더 권한 확인
```bash
# Windows
icacls data

# macOS/Linux
ls -la data
```

2. 데이터베이스 파일 재생성
```bash
# 기존 파일 백업
mv data/database.db data/database.db.backup
# API 서버 재시작 (자동 생성됨)
npm run api-server
```

## 보안 고려사항

### 프로덕션 환경

1. **환경 변수 보호**
   - `.env` 파일을 `.gitignore`에 추가
   - 민감한 정보는 환경 변수로 관리

2. **CORS 설정**
   - 프로덕션에서는 특정 도메인만 허용
   - `api-server.js`에서 CORS 설정 수정:
```javascript
res.setHeader('Access-Control-Allow-Origin', 'https://yourdomain.com');
```

3. **입력 검증**
   - 이미 구현된 파일 크기 제한 (10MB) 유지
   - 필요시 추가 검증 로직 구현

4. **데이터베이스 백업**
   - 정기적으로 `data/database.db` 백업
   - 백업 스크립트 예시:
```bash
# Windows (PowerShell)
Copy-Item data\database.db -Destination "data\backups\database_$(Get-Date -Format 'yyyyMMdd_HHmmss').db"

# macOS/Linux
cp data/database.db "data/backups/database_$(date +%Y%m%d_%H%M%S).db"
```

## 추가 리소스

- **프로젝트 문서**: `README.md`
- **사용자 가이드**: `docs/사용자_가이드.md` (별도 생성 필요)
- **API 문서**: `docs/API_문서.md` (별도 생성 필요)

## 지원

문제가 발생하거나 도움이 필요한 경우:
1. 로그 파일 확인 (터미널 출력)
2. 문제 해결 섹션 참조
3. 이슈 등록 또는 관리자에게 문의

---

**마지막 업데이트**: 2025년 12월

